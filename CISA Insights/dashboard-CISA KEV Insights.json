{"$schema":"https://dataexplorer.azure.com/static/d/schema/48/dashboard.json","id":"27000b84-ae26-417b-9acd-1f7efc8d7ed3","eTag":"ed5caf4b-65ec-43b4-a822-1f97914e5850","schema_version":"48","title":"CISA KEV Insights test","autoRefresh":{"enabled":false},"baseQueries":[{"id":"924b7d78-f31c-454b-bb73-5f7bd36949be","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"text":"externaldata(cveID: string, vendorProject: string, product: string, vulnerabilityName: string, dateAdded: datetime, shortDescription: string, requiredAction: string, dueDate: datetime, knownRansomwareCampaignUse:string,notes:string)\n[\nh@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\n]\nwith(format='csv',ignorefirstrecord=true)","usedVariables":[],"variableName":"kevdata"}],"tiles":[{"id":"dedfe55f-e876-4736-b63f-9cc0233d061b","title":"Count by vendor","description":"","visualType":"table","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":0,"y":22,"width":6,"height":9},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor","kevdata"],"text":"kevdata\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| summarize VendorCount=count() by vendorProject\n| sort by vendorProject asc "},"visualOptions":{"table__enableRenderLinks":true,"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[]}},{"id":"65f3e663-4f32-4402-8135-7d44d86e19f9","title":"Count by vendor (known ransomware)","description":"","visualType":"table","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":12,"y":22,"width":6,"height":9},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor","kevdata"],"text":"kevdata\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| where knownRansomwareCampaignUse =~ \"known\"\n| summarize VendorCount=count() by vendorProject\n| sort by vendorProject asc "},"visualOptions":{"table__enableRenderLinks":true,"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[]}},{"id":"4de92ced-a8db-42ff-b31c-e93219fb3ee7","title":"Total vulnerability count by year","description":"","visualType":"timechart","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":0,"y":14,"width":12,"height":8},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor"],"text":"externaldata(cveID: string, vendorProject: string, product: string, vulnerabilityName: string, dateAdded: datetime, shortDescription: string, requiredAction: string, dueDate: datetime, knownRansomwareCampaignUse:string,notes:string)\n[\nh@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\n]\nwith(format='csv',ignorefirstrecord=true)\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| summarize Count=count() by startofyear(dateAdded)\n| render timechart "},"visualOptions":{"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"xColumnTitle":"","xColumn":null,"yColumns":["Count"],"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"daa735d4-e430-4816-8753-9a1dbb4cce07","title":"Total vulnerability count by year (known ransomware)","description":"","visualType":"timechart","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":12,"y":14,"width":12,"height":8},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor"],"text":"externaldata(cveID: string, vendorProject: string, product: string, vulnerabilityName: string, dateAdded: datetime, shortDescription: string, requiredAction: string, dueDate: datetime, knownRansomwareCampaignUse:string,notes:string)\n[\nh@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\n]\nwith(format='csv',ignorefirstrecord=true)\n| where knownRansomwareCampaignUse =~ \"known\"\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| summarize Count=count() by startofyear(dateAdded)\n| render timechart "},"visualOptions":{"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"xColumnTitle":"","xColumn":null,"yColumns":["Count"],"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"4101e2b7-5cdc-4a1a-b573-daf215056868","title":"Count by vendor and product","description":"","visualType":"table","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":6,"y":22,"width":6,"height":9},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor","kevdata"],"text":"kevdata\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| summarize Count=count() by vendorProject, product\n| sort by vendorProject asc, product asc"},"visualOptions":{"table__enableRenderLinks":true,"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[]}},{"id":"81d2c15c-3e61-4765-aa7b-2e94126794b2","title":"Count by vendor and product (known ransomware)","description":"","visualType":"table","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":18,"y":22,"width":6,"height":9},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor","kevdata"],"text":"kevdata\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| where knownRansomwareCampaignUse =~ \"known\"\n| summarize VendorCount=count() by vendorProject, product\n| sort by vendorProject asc, product asc "},"visualOptions":{"table__enableRenderLinks":true,"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[]}},{"id":"861e19c5-5a54-4179-a628-82f36fc5d391","title":"CISA KEV Insights Dashboard","description":"","visualType":"markdownCard","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":0,"y":0,"width":24,"height":3},"query":{"kind":"inline","usedVariables":[],"text":"Known Exploitable Vulnerbailities Overview - this dashboard loads the vulnerability data from the CISA to provide insights, select vendors from the drop down list, otherwise it will default to all vendors\r\n\r\nSome queries exclude the initial upload date where CISA bulk imported historical data on 2021-11-03T00:00:00.000Z as it throws off calculations such as average & time between events"},"visualOptions":{}},{"id":"33f3dc6b-4f0f-4779-9981-49e8a6ba75b3","title":"Time delta between vulnerabilities","description":"","visualType":"table","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":0,"y":33,"width":12,"height":9},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor","kevdata"],"text":"kevdata\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| where dateAdded != \"2021-11-03T00:00:00.000Z\"\n| project dateAdded, vendorProject, product, cveID, knownRansomwareCampaignUse\n| sort by vendorProject asc, dateAdded desc \n| extend ['Days Between Vulnerabilities'] = iff(prev(vendorProject) == vendorProject, datetime_diff('day', prev(dateAdded), dateAdded), long(null))"},"visualOptions":{"table__enableRenderLinks":true,"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[]}},{"id":"fd0cb6ed-d161-4e7c-8096-699f6090c936","title":"Time delta between vulnerabilities (known ransomware)","description":"","visualType":"table","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":12,"y":33,"width":12,"height":9},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor","kevdata"],"text":"kevdata\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| where dateAdded != \"2021-11-03T00:00:00.000Z\"\n| project dateAdded, vendorProject, product, cveID, knownRansomwareCampaignUse\n| where knownRansomwareCampaignUse =~ \"known\"\n| sort by vendorProject asc, dateAdded desc \n| extend ['Days Between Vulnerabilities'] = iff(prev(vendorProject) == vendorProject, datetime_diff('day', prev(dateAdded), dateAdded), long(null))"},"visualOptions":{"table__enableRenderLinks":true,"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[]}},{"id":"39971219-444e-494b-b2e9-2102b3aed943","title":"Average time delta between vulnerabilities per vendor","description":"","visualType":"table","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":0,"y":42,"width":12,"height":9},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor","kevdata"],"text":"kevdata\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| where dateAdded != \"2021-11-03T00:00:00.000Z\"\n| project dateAdded, vendorProject, product, cveID, knownRansomwareCampaignUse\n| sort by vendorProject asc, dateAdded desc \n| extend ['Days Between Vulnerabilities'] = iff(prev(vendorProject) == vendorProject, datetime_diff('day', prev(dateAdded), dateAdded), long(null))\n| summarize ['Total Count of Vulnerabilities']=count(),['Average Days Between Vulnerabilities']=round(avg(['Days Between Vulnerabilities']),0) by vendorProject\n| where ['Total Count of Vulnerabilities'] > 1"},"visualOptions":{"table__enableRenderLinks":true,"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[]}},{"id":"14f84b7d-f987-49b7-acf5-455bd5723cc8","title":"Average time delta between vulnerabilities per vendor (known ransomware)","description":"","visualType":"table","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":12,"y":42,"width":12,"height":9},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor","kevdata"],"text":"kevdata\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| where dateAdded != \"2021-11-03T00:00:00.000Z\"\n| project dateAdded, vendorProject, product, cveID, knownRansomwareCampaignUse\n| where knownRansomwareCampaignUse =~ \"known\"\n| sort by vendorProject asc, dateAdded desc \n| extend ['Days Between Vulnerabilities'] = iff(prev(vendorProject) == vendorProject, datetime_diff('day', prev(dateAdded), dateAdded), long(null))\n| summarize ['Total Count of Vulnerabilities']=count(),['Average Days Between Vulnerabilities']=round(avg(['Days Between Vulnerabilities']),0) by vendorProject\n| where ['Total Count of Vulnerabilities'] > 1"},"visualOptions":{"table__enableRenderLinks":true,"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[]}},{"id":"2e3aea20-42e6-45c3-9319-0d14a2866ecd","title":"Time between vulnerability events","description":"","visualType":"markdownCard","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":0,"y":31,"width":24,"height":2},"query":{"kind":"inline","usedVariables":[],"text":"These queries calculate the time between vulnerability events and then also provides the average days between events, where multiple vulnerabilities are uploaded on the same day, the time delta is 0 and therefore drops the average"},"visualOptions":{}},{"id":"6eb2a82e-eafa-4254-8346-6b6ee14d958b","title":"Total vulnerability count by month","description":"","visualType":"timechart","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":0,"y":3,"width":18,"height":11},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor"],"text":"externaldata(cveID: string, vendorProject: string, product: string, vulnerabilityName: string, dateAdded: datetime, shortDescription: string, requiredAction: string, dueDate: datetime, knownRansomwareCampaignUse:string,notes:string)\n[\nh@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\n]\nwith(format='csv',ignorefirstrecord=true)\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| summarize Count=count() by startofmonth(dateAdded)\n| render timechart "},"visualOptions":{"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"xColumnTitle":"","xColumn":null,"yColumns":["Count"],"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"f726775b-d60e-44f8-8d6c-54abf898758a","title":"Known vs unknown ransomware vulnerabilities","description":"","visualType":"pie","pageId":"9e72810d-6eaf-4837-8e40-67851b58d175","layout":{"x":18,"y":3,"width":6,"height":11},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["Vendor"],"text":"externaldata(cveID: string, vendorProject: string, product: string, vulnerabilityName: string, dateAdded: datetime, shortDescription: string, requiredAction: string, dueDate: datetime, knownRansomwareCampaignUse:string,notes:string)\n[\nh@'https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv'\n]\nwith(format='csv',ignorefirstrecord=true)\n| where vendorProject has_any (Vendor) or isempty(Vendor)\n| summarize Count=count() by knownRansomwareCampaignUse"},"visualOptions":{"hideLegend":false,"xColumn":null,"yColumns":["Count"],"seriesColumns":null,"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","pie__topNSlices":null,"crossFilter":[],"drillthrough":[]}}],"parameters":[{"kind":"string","id":"a68b6923-ec9b-43c7-864e-2efe9173220b","displayName":"Vendor","description":"Vendor","variableName":"Vendor","selectionType":"array","includeAllOption":true,"defaultValue":{"kind":"all"},"dataSource":{"kind":"query","columns":{"value":"vendorProject"},"query":{"kind":"inline","dataSource":{"kind":"inline","dataSourceId":"d4ceef00-33be-45bb-943a-0b8241120fa8"},"usedVariables":["kevdata"],"text":"kevdata\n| distinct vendorProject\n| sort by vendorProject asc "}},"showOnPages":{"kind":"all"}}],"dataSources":[{"id":"d4ceef00-33be-45bb-943a-0b8241120fa8","name":"sampledata","clusterUri":"https://help.kusto.windows.net/","database":"Samples","kind":"manual-kusto","scopeId":"kusto"}],"pages":[{"name":"KEV Insights","id":"9e72810d-6eaf-4837-8e40-67851b58d175"}]}